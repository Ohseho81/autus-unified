{
  "name": "AUTUS CrewAI ìžë™ ë¶„ì„",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [{ "field": "hours", "hoursInterval": 6 }]
        }
      },
      "id": "schedule",
      "name": "6ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "={{ $env.AUTUS_API_URL }}/nodes?limit=1000"
      },
      "id": "get_nodes",
      "name": "ë…¸ë“œ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "position": [450, 250]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "={{ $env.AUTUS_API_URL }}/motions?limit=5000"
      },
      "id": "get_motions",
      "name": "ëª¨ì…˜ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "position": [450, 350]
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll"
      },
      "id": "merge",
      "name": "ë°ì´í„° ë³‘í•©",
      "type": "n8n-nodes-base.merge",
      "position": [650, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.AUTUS_API_URL }}/crewai/analyze",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ nodes: $('ë…¸ë“œ ì¡°íšŒ').item.json, motions: $('ëª¨ì…˜ ì¡°íšŒ').item.json }) }}"
      },
      "id": "crewai_analyze",
      "name": "CrewAI ë¶„ì„",
      "type": "n8n-nodes-base.httpRequest",
      "position": [850, 300]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.total_monthly_impact }}",
              "operation": "largerEqual",
              "value2": 1000000
            }
          ]
        }
      },
      "id": "impact_check",
      "name": "ì˜í–¥ë„ ì²´í¬ (100ë§Œì›+)",
      "type": "n8n-nodes-base.if",
      "position": [1050, 300]
    },
    {
      "parameters": {
        "channel": "#autus-alerts",
        "text": "ðŸ¤– *AUTUS CrewAI ë¶„ì„ ê²°ê³¼*\n\n*ì‚­ì œ ëŒ€ìƒ:* {{ $json.delete.targets.length }}ê°œ\n*ìžë™í™” ëŒ€ìƒ:* {{ $json.automate.targets.length }}ê°œ\n*ì™¸ë¶€ìš©ì—­ ì¶”ì²œ:* {{ $json.outsource.recommendations.length }}ê°œ\n\nðŸ’° *ì˜ˆìƒ ì›” ì˜í–¥:* â‚©{{ Math.round($json.total_monthly_impact).toLocaleString() }}\n\nìžì„¸ížˆ ë³´ê¸°: {{ $env.AUTUS_DASHBOARD_URL }}"
      },
      "id": "slack_alert",
      "name": "Slack ì•Œë¦¼",
      "type": "n8n-nodes-base.slack",
      "position": [1250, 200]
    },
    {
      "parameters": {
        "functionCode": "// ë¶„ì„ ê²°ê³¼ ì €ìž¥\nconst result = $input.item.json;\n\n// ìžë™ ì‚­ì œ ì‹¤í–‰ (ê°€ì¹˜ â‰¤ 0)\nconst autoDeleteTargets = result.delete?.targets?.filter(t => t.value <= -1000000) || [];\n\nreturn [{\n  json: {\n    analyzed_at: new Date().toISOString(),\n    auto_delete_count: autoDeleteTargets.length,\n    total_impact: result.total_monthly_impact\n  }\n}];"
      },
      "id": "process_result",
      "name": "ê²°ê³¼ ì²˜ë¦¬",
      "type": "n8n-nodes-base.function",
      "position": [1250, 400]
    }
  ],
  "connections": {
    "6ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰": {
      "main": [
        [
          { "node": "ë…¸ë“œ ì¡°íšŒ", "type": "main", "index": 0 },
          { "node": "ëª¨ì…˜ ì¡°íšŒ", "type": "main", "index": 0 }
        ]
      ]
    },
    "ë…¸ë“œ ì¡°íšŒ": { "main": [[{ "node": "ë°ì´í„° ë³‘í•©", "type": "main", "index": 0 }]] },
    "ëª¨ì…˜ ì¡°íšŒ": { "main": [[{ "node": "ë°ì´í„° ë³‘í•©", "type": "main", "index": 1 }]] },
    "ë°ì´í„° ë³‘í•©": { "main": [[{ "node": "CrewAI ë¶„ì„", "type": "main", "index": 0 }]] },
    "CrewAI ë¶„ì„": { "main": [[{ "node": "ì˜í–¥ë„ ì²´í¬ (100ë§Œì›+)", "type": "main", "index": 0 }]] },
    "ì˜í–¥ë„ ì²´í¬ (100ë§Œì›+)": {
      "main": [
        [{ "node": "Slack ì•Œë¦¼", "type": "main", "index": 0 }],
        [{ "node": "ê²°ê³¼ ì²˜ë¦¬", "type": "main", "index": 0 }]
      ]
    }
  }
}
