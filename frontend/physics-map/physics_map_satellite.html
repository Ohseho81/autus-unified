<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ›°ï¸ AUTUS Physics Map - Satellite Edition</title>
  
  <!-- Leaflet (ìœ„ì„± íƒ€ì¼ ë Œë”ë§) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #000;
      overflow: hidden;
    }
    
    #map {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    
    #canvas-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
    }
    
    /* í—¤ë” */
    .header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.95) 0%, transparent 100%);
      padding: 24px 32px;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    
    .header-left h1 {
      color: #fff;
      font-size: 24px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 12px;
      text-shadow: 0 2px 20px rgba(0, 204, 255, 0.5);
    }
    
    .header-left .subtitle {
      color: #666;
      font-size: 11px;
      margin-top: 8px;
      letter-spacing: 2px;
      text-transform: uppercase;
    }
    
    .header-right {
      display: flex;
      gap: 40px;
    }
    
    .stat { text-align: right; }
    .stat-label { color: #555; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; }
    .stat-value { font-size: 24px; font-weight: 700; margin-top: 4px; }
    
    .green { color: #00ff88; text-shadow: 0 0 20px rgba(0, 255, 136, 0.7); }
    .cyan { color: #00ccff; text-shadow: 0 0 20px rgba(0, 204, 255, 0.7); }
    .gold { color: #ffcc00; text-shadow: 0 0 20px rgba(255, 204, 0, 0.7); }
    .red { color: #ff4466; text-shadow: 0 0 20px rgba(255, 68, 102, 0.7); }
    .purple { color: #9966ff; text-shadow: 0 0 20px rgba(153, 102, 255, 0.7); }
    
    /* ìœ„ì„± ì •ë³´ íŒ¨ë„ */
    .satellite-panel {
      position: absolute;
      top: 120px;
      right: 32px;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(0, 204, 255, 0.3);
      border-radius: 16px;
      padding: 20px;
      backdrop-filter: blur(20px);
      z-index: 100;
      min-width: 260px;
    }
    
    .satellite-title {
      color: #00ccff;
      font-size: 13px;
      font-weight: bold;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .satellite-info {
      color: #888;
      font-size: 11px;
      line-height: 1.8;
    }
    
    .satellite-info strong { color: #fff; }
    
    .ndvi-bar {
      height: 8px;
      background: linear-gradient(90deg, #8B4513 0%, #FFD700 25%, #90EE90 50%, #228B22 75%, #006400 100%);
      border-radius: 4px;
      margin: 12px 0;
    }
    
    .ndvi-labels {
      display: flex;
      justify-content: space-between;
      font-size: 9px;
      color: #666;
    }
    
    /* ë…¸ë“œ ì •ë³´ íŒ¨ë„ */
    .info-panel {
      position: absolute;
      top: 120px;
      left: 32px;
      background: rgba(0, 0, 0, 0.95);
      border: 1px solid rgba(0, 255, 136, 0.3);
      border-radius: 16px;
      padding: 24px;
      backdrop-filter: blur(20px);
      z-index: 100;
      min-width: 320px;
      display: none;
    }
    
    .info-panel.visible { display: block; }
    
    .info-header {
      display: flex;
      align-items: center;
      gap: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 16px;
    }
    
    .info-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      box-shadow: 0 0 30px currentColor;
    }
    
    .info-name { color: #fff; font-weight: bold; font-size: 20px; }
    .info-type { color: #888; font-size: 12px; margin-top: 4px; }
    .info-location { color: #00ccff; font-size: 11px; margin-top: 4px; }
    
    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 13px;
    }
    
    .info-row-label { color: #666; }
    .info-row-value { font-weight: bold; color: #fff; }
    
    .info-status {
      margin-top: 16px;
      padding: 12px;
      border-radius: 10px;
      text-align: center;
      font-size: 12px;
      font-weight: bold;
    }
    
    .status-optimal { background: rgba(0, 255, 136, 0.15); border: 1px solid rgba(0, 255, 136, 0.4); color: #00ff88; }
    .status-warning { background: rgba(255, 204, 0, 0.15); border: 1px solid rgba(255, 204, 0, 0.4); color: #ffcc00; }
    .status-bottleneck { background: rgba(255, 68, 102, 0.15); border: 1px solid rgba(255, 68, 102, 0.4); color: #ff4466; animation: pulse 1.5s infinite; }
    .status-prediction { background: rgba(255, 204, 0, 0.1); border: 1px solid rgba(255, 204, 0, 0.3); color: #ffcc00; }
    
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
    
    /* ë³‘ëª© íŒ¨ë„ */
    .bottleneck-panel {
      position: absolute;
      bottom: 120px;
      left: 32px;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(255, 68, 102, 0.4);
      border-radius: 16px;
      padding: 20px;
      z-index: 100;
      min-width: 300px;
    }
    
    .bottleneck-title {
      color: #ff4466;
      font-size: 13px;
      font-weight: bold;
      margin-bottom: 14px;
    }
    
    .bottleneck-item {
      background: rgba(255, 68, 102, 0.1);
      border: 1px solid rgba(255, 68, 102, 0.3);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 10px;
    }
    
    .bottleneck-item .name { color: #fff; font-weight: bold; font-size: 13px; }
    .bottleneck-item .issue { color: #ff4466; font-size: 11px; margin-top: 4px; }
    .bottleneck-item .action { color: #ffcc00; font-size: 10px; margin-top: 8px; }
    
    /* ê¸°íšŒ íŒ¨ë„ */
    .opportunity-panel {
      position: absolute;
      bottom: 120px;
      right: 32px;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(255, 204, 0, 0.4);
      border-radius: 16px;
      padding: 20px;
      z-index: 100;
      min-width: 260px;
    }
    
    .opportunity-title {
      color: #ffcc00;
      font-size: 13px;
      font-weight: bold;
      margin-bottom: 14px;
    }
    
    .opportunity-item {
      background: rgba(255, 204, 0, 0.1);
      border: 1px solid rgba(255, 204, 0, 0.3);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 10px;
    }
    
    .opportunity-item .name { color: #fff; font-weight: bold; font-size: 13px; }
    .opportunity-item .value { color: #ffcc00; font-size: 14px; font-weight: bold; margin-top: 4px; }
    .opportunity-item .timeline { color: #888; font-size: 10px; margin-top: 4px; }
    
    /* ë²”ë¡€ */
    .legend-panel {
      position: absolute;
      top: 380px;
      right: 32px;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      padding: 16px;
      z-index: 100;
    }
    
    .legend-title {
      color: #555;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 12px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
      font-size: 11px;
      color: #888;
    }
    
    .legend-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }
    
    .legend-line {
      width: 30px;
      height: 3px;
      border-radius: 2px;
    }
    
    /* ì»¨íŠ¸ë¡¤ */
    .controls {
      position: absolute;
      bottom: 32px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12px;
      z-index: 100;
    }
    
    .control-btn {
      padding: 12px 24px;
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid rgba(0, 204, 255, 0.4);
      border-radius: 25px;
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .control-btn:hover {
      background: rgba(0, 204, 255, 0.2);
      border-color: #00ccff;
      transform: translateY(-2px);
    }
    
    .control-btn.active {
      background: rgba(0, 255, 136, 0.2);
      border-color: #00ff88;
    }
    
    /* ë ˆì´ì–´ ì„ íƒê¸° */
    .layer-selector {
      position: absolute;
      top: 120px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(0, 204, 255, 0.3);
      border-radius: 25px;
      padding: 8px;
      display: flex;
      gap: 4px;
      z-index: 100;
    }
    
    .layer-btn {
      padding: 8px 16px;
      background: transparent;
      border: none;
      border-radius: 20px;
      color: #888;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .layer-btn:hover { color: #fff; }
    .layer-btn.active {
      background: rgba(0, 204, 255, 0.3);
      color: #00ccff;
    }
    
    /* í‘¸í„° */
    .footer {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(0deg, rgba(0, 0, 0, 0.9) 0%, transparent 100%);
      padding: 20px 32px;
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: #444;
      z-index: 50;
    }
    
    /* Leaflet ì»¤ìŠ¤í…€ */
    .leaflet-control-attribution { display: none !important; }
    .leaflet-control-zoom { display: none !important; }
  </style>
</head>
<body>
  <div id="map"></div>
  <canvas id="canvas-overlay"></canvas>
  
  <!-- í—¤ë” -->
  <div class="header">
    <div class="header-left">
      <h1>ğŸ›°ï¸ AUTUS Physics Map - Satellite Edition</h1>
      <div class="subtitle">Sentinel-2 / ESRI Imagery â€¢ ëª¨ë“  ê°œì²´ëŠ” ì‚¬ëŒ â€¢ í”¼ì‹œìŠ¤ í•´ë‹µì€ ëˆ</div>
    </div>
    <div class="header-right">
      <div class="stat">
        <div class="stat-label">Total Value</div>
        <div class="stat-value green">â‚©7.09ì–µ</div>
      </div>
      <div class="stat">
        <div class="stat-label">Net Cashflow</div>
        <div class="stat-value cyan">â‚©4.23ì–µ</div>
      </div>
      <div class="stat">
        <div class="stat-label">Synergy</div>
        <div class="stat-value purple">â‚©2.86ì–µ</div>
      </div>
      <div class="stat">
        <div class="stat-label">12M Forecast</div>
        <div class="stat-value gold">â‚©23ì–µ</div>
      </div>
    </div>
  </div>
  
  <!-- ë ˆì´ì–´ ì„ íƒê¸° -->
  <div class="layer-selector">
    <button class="layer-btn active" data-layer="satellite">ğŸ›°ï¸ Satellite</button>
    <button class="layer-btn" data-layer="hybrid">ğŸ—ºï¸ Hybrid</button>
    <button class="layer-btn" data-layer="terrain">â›°ï¸ Terrain</button>
    <button class="layer-btn" data-layer="dark">ğŸŒ™ Dark</button>
    <button class="layer-btn" data-layer="ndvi">ğŸŒ¿ NDVI</button>
  </div>
  
  <!-- ìœ„ì„± ì •ë³´ íŒ¨ë„ -->
  <div class="satellite-panel">
    <div class="satellite-title">ğŸ›°ï¸ Satellite Data Info</div>
    <div class="satellite-info">
      <strong>Source:</strong> ESRI World Imagery / Sentinel-2<br>
      <strong>Resolution:</strong> 10m (Optical)<br>
      <strong>Coverage:</strong> Global<br>
      <strong>Update:</strong> 5-day cycle<br><br>
      <strong>NDVI (ì„œìš¸):</strong> 0.35 ~ 0.45
    </div>
    <div class="ndvi-bar"></div>
    <div class="ndvi-labels">
      <span>-1 (Water)</span>
      <span>0 (Urban)</span>
      <span>0.5</span>
      <span>1 (Forest)</span>
    </div>
  </div>
  
  <!-- ë…¸ë“œ ì •ë³´ íŒ¨ë„ -->
  <div class="info-panel" id="info-panel">
    <div class="info-header">
      <div class="info-icon" id="info-icon">ğŸ‘‘</div>
      <div>
        <div class="info-name" id="info-name">ê¹€ì„¸í˜¸</div>
        <div class="info-type" id="info-type">SOVEREIGN â€¢ ëŒ€í‘œ</div>
        <div class="info-location" id="info-location">ğŸ“ ì„œìš¸ ê°•ë‚¨êµ¬</div>
      </div>
    </div>
    <div class="info-row">
      <span class="info-row-label">Inflow (ìœ ì…)</span>
      <span class="info-row-value cyan" id="info-inflow">â‚©4.5ì–µ</span>
    </div>
    <div class="info-row">
      <span class="info-row-label">Outflow (ìœ ì¶œ)</span>
      <span class="info-row-value red" id="info-outflow">â‚©1.8ì–µ</span>
    </div>
    <div class="info-row">
      <span class="info-row-label">Synergy</span>
      <span class="info-row-value purple" id="info-synergy">+â‚©8,500ë§Œ</span>
    </div>
    <div class="info-row">
      <span class="info-row-label">Total Value</span>
      <span class="info-row-value green" id="info-value">â‚©2.99ì–µ</span>
    </div>
    <div class="info-status status-optimal" id="info-status">
      âœ… OPTIMAL
    </div>
  </div>
  
  <!-- ë³‘ëª© íŒ¨ë„ -->
  <div class="bottleneck-panel">
    <div class="bottleneck-title">âš ï¸ ëˆ ë³‘ëª© ê°ì§€ (2ê±´)</div>
    <div class="bottleneck-item">
      <div class="name">ğŸ‡ºğŸ‡¸ ë‰´ìš• ì—ì´ì „ì‹œ</div>
      <div class="issue">ìœ ì¶œ â‚©4,500ë§Œ > ìœ ì… â‚©3,000ë§Œ (ROI -33%)</div>
      <div class="action">ğŸ’¡ ê³„ì•½ ì¬í˜‘ìƒ ë˜ëŠ” ëŒ€ì²´ ì—ì´ì „ì‹œ ê²€í† </div>
    </div>
    <div class="bottleneck-item">
      <div class="name">ğŸ‡¦ğŸ‡º í˜¸ì£¼ ê³µê¸‰ì‚¬</div>
      <div class="issue">ìœ ì¶œ â‚©2,400ë§Œ, ì‹œë„ˆì§€ -â‚©200ë§Œ</div>
      <div class="action">ğŸ’¡ êµ­ë‚´ ê³µê¸‰ì„  ëŒ€ì²´ ë˜ëŠ” ê°€ê²© í˜‘ìƒ</div>
    </div>
  </div>
  
  <!-- ê¸°íšŒ íŒ¨ë„ -->
  <div class="opportunity-panel">
    <div class="opportunity-title">â­ ì„±ì¥ ê¸°íšŒ (3ê±´)</div>
    <div class="opportunity-item">
      <div class="name">ğŸ‡¦ğŸ‡ª ë‘ë°”ì´ ìŠ¤í°ì„œ</div>
      <div class="value">â‚©5ì–µ ì˜ˆìƒ</div>
      <div class="timeline">ğŸ“… 2025 Q2</div>
    </div>
    <div class="opportunity-item">
      <div class="name">ğŸ‡¬ğŸ‡§ ëŸ°ë˜ í™•ì¥</div>
      <div class="value">â‚©3ì–µ ì˜ˆìƒ</div>
      <div class="timeline">ğŸ“… 2025 Q3</div>
    </div>
    <div class="opportunity-item">
      <div class="name">ğŸ‡¨ğŸ‡³ ë² ì´ì§• JV</div>
      <div class="value">â‚©8ì–µ ì˜ˆìƒ</div>
      <div class="timeline">ğŸ“… 2025 Q4</div>
    </div>
  </div>
  
  <!-- ë²”ë¡€ -->
  <div class="legend-panel">
    <div class="legend-title">Legend</div>
    <div class="legend-item">
      <div class="legend-dot" style="background: #00ff88;"></div>
      <span>ì£¼ê¶Œì</span>
    </div>
    <div class="legend-item">
      <div class="legend-dot" style="background: #00ccff;"></div>
      <span>íŒ€/íŒŒíŠ¸ë„ˆ</span>
    </div>
    <div class="legend-item">
      <div class="legend-dot" style="background: #ffcc00;"></div>
      <span>ê³ ê°/ì˜ˆì¸¡</span>
    </div>
    <div class="legend-item">
      <div class="legend-dot" style="background: #ff4466;"></div>
      <span>ë³‘ëª©</span>
    </div>
    <div class="legend-item" style="margin-top: 10px;">
      <div class="legend-line" style="background: linear-gradient(90deg, #00ff88, #00ccff);"></div>
      <span>ëˆ ìœ ì…</span>
    </div>
    <div class="legend-item">
      <div class="legend-line" style="background: linear-gradient(90deg, #ff4466, #ff6600);"></div>
      <span>ëˆ ìœ ì¶œ</span>
    </div>
    <div class="legend-item">
      <div class="legend-line" style="background: linear-gradient(90deg, #9966ff, #00ccff);"></div>
      <span>ì‹œë„ˆì§€</span>
    </div>
  </div>
  
  <!-- ì»¨íŠ¸ë¡¤ -->
  <div class="controls">
    <button class="control-btn" id="btn-korea">ğŸ‡°ğŸ‡· ì„œìš¸</button>
    <button class="control-btn" id="btn-asia">ğŸŒ ì•„ì‹œì•„</button>
    <button class="control-btn" id="btn-world">ğŸŒ ì„¸ê³„</button>
    <button class="control-btn active" id="btn-animate">âœ¨ ë³„ë˜¥ë³„</button>
    <button class="control-btn active" id="btn-bottleneck">âš ï¸ ë³‘ëª©</button>
  </div>
  
  <!-- í‘¸í„° -->
  <div class="footer">
    <span>ğŸ–±ï¸ ë“œë˜ê·¸: ì´ë™ | ìŠ¤í¬ë¡¤: ì¤Œ | ë…¸ë“œ í´ë¦­: ìƒì„¸ ì •ë³´</span>
    <span>AUTUS Physics Map v3.0 â€¢ Satellite Edition â€¢ Sentinel-2 / ESRI Imagery</span>
  </div>
  
  <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ìœ„ì„± íƒ€ì¼ ë ˆì´ì–´ ì •ì˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    const tileLayers = {
      satellite: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Â© ESRI World Imagery',
        maxZoom: 19
      }),
      hybrid: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Â© ESRI',
        maxZoom: 19
      }),
      terrain: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenTopoMap',
        maxZoom: 17
      }),
      dark: L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: 'Â© CartoDB',
        maxZoom: 19
      }),
      ndvi: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Â© ESRI (NDVI Simulation)',
        maxZoom: 19,
        className: 'ndvi-filter'
      })
    };
    
    // NDVI í•„í„° CSS
    const ndviStyle = document.createElement('style');
    ndviStyle.textContent = `
      .ndvi-filter {
        filter: saturate(2) hue-rotate(60deg) contrast(1.2);
      }
    `;
    document.head.appendChild(ndviStyle);
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Leaflet ì§€ë„ ì´ˆê¸°í™”
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    const map = L.map('map', {
      center: [30, 100],
      zoom: 3,
      zoomControl: false,
      attributionControl: false
    });
    
    let currentLayer = tileLayers.satellite;
    currentLayer.addTo(map);
    
    // ë ˆì´ì–´ ë³€ê²½
    document.querySelectorAll('.layer-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.layer-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        map.removeLayer(currentLayer);
        currentLayer = tileLayers[this.dataset.layer];
        currentLayer.addTo(map);
      });
    });
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ê°€ìƒ ë°ì´í„° (ê¸€ë¡œë²Œ êµìœ¡ ì‚¬ì—…)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    const nodes = [
      // í•œêµ­ (ì„œìš¸)
      { id: 'P01', name: 'ê¹€ì„¸í˜¸', label: 'ëŒ€í‘œ', role: 'SOVEREIGN', 
        lat: 37.5085, lon: 127.0634, location: 'ì„œìš¸ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ',
        inflow: 450000000, outflow: 180000000, synergy: 85000000,
        status: 'optimal', icon: 'ğŸ‘‘', color: '#00ff88' },
      
      { id: 'P02', name: 'ì´ì •ë¯¼', label: 'ìš´ì˜ë§¤ë‹ˆì €', role: 'OPERATOR',
        lat: 37.4979, lon: 127.0276, location: 'ì„œìš¸ ì„œì´ˆêµ¬',
        inflow: 85000000, outflow: 25000000, synergy: 12000000,
        status: 'optimal', icon: 'ğŸ‘¤', color: '#00ccff' },
      
      { id: 'P03', name: 'ë°•ì¤€ì˜', label: 'í—¤ë“œì½”ì¹˜', role: 'EXECUTOR',
        lat: 37.5172, lon: 127.0473, location: 'ì„œìš¸ ì„±ë™êµ¬',
        inflow: 72000000, outflow: 18000000, synergy: 15000000,
        status: 'optimal', icon: 'ğŸ‘¤', color: '#00ccff' },
      
      { id: 'P04', name: 'ìµœìˆ˜ì§„', label: 'ë§ˆì¼€íŒ…', role: 'GROWTH',
        lat: 37.5662, lon: 126.9779, location: 'ì„œìš¸ ì¢…ë¡œêµ¬',
        inflow: 45000000, outflow: 35000000, synergy: 25000000,
        status: 'warning', icon: 'ğŸ“¢', color: '#ff6600' },
      
      { id: 'C01', name: 'VIP í•™ìƒêµ°', label: 'VIP ê³ ê°', role: 'CUSTOMER',
        lat: 37.5200, lon: 127.0400, location: 'ì„œìš¸ ê°•ë‚¨ê¶Œ',
        inflow: 0, outflow: 250000000, synergy: 30000000,
        status: 'optimal', icon: 'ğŸ‘¥', color: '#ffcc00' },
      
      { id: 'C03', name: 'í•™ë¶€ëª¨íšŒ', label: 'í•™ë¶€ëª¨', role: 'SPONSOR',
        lat: 37.5300, lon: 127.0200, location: 'ì„œìš¸ ê°•ë‚¨/ì„œì´ˆ',
        inflow: 410000000, outflow: 0, synergy: 20000000,
        status: 'optimal', icon: 'ğŸ’°', color: '#ff6600' },
      
      // í•´ì™¸
      { id: 'X01', name: 'ë„ì¿„ íŒŒíŠ¸ë„ˆ', label: 'ì¼ë³¸', role: 'PARTNER',
        lat: 35.6762, lon: 139.6503, location: 'Tokyo, Japan',
        inflow: 80000000, outflow: 20000000, synergy: 35000000,
        status: 'optimal', icon: 'ğŸ‡¯ğŸ‡µ', color: '#00ccff' },
      
      { id: 'X02', name: 'ì‹±ê°€í¬ë¥´ íˆ¬ìì', label: 'ì‹±ê°€í¬ë¥´', role: 'INVESTOR',
        lat: 1.3521, lon: 103.8198, location: 'Singapore',
        inflow: 200000000, outflow: 0, synergy: 50000000,
        status: 'optimal', icon: 'ğŸ‡¸ğŸ‡¬', color: '#ff6600' },
      
      { id: 'X03', name: 'ë‰´ìš• ì—ì´ì „ì‹œ', label: 'ë¯¸êµ­', role: 'PARTNER',
        lat: 40.7128, lon: -74.0060, location: 'New York, USA',
        inflow: 30000000, outflow: 45000000, synergy: -5000000,
        status: 'bottleneck', icon: 'ğŸ‡ºğŸ‡¸', color: '#ff4466' },
      
      { id: 'X04', name: 'í˜¸ì£¼ ê³µê¸‰ì‚¬', label: 'í˜¸ì£¼', role: 'SUPPLIER',
        lat: -33.8688, lon: 151.2093, location: 'Sydney, Australia',
        inflow: 0, outflow: 24000000, synergy: -2000000,
        status: 'bottleneck', icon: 'ğŸ‡¦ğŸ‡º', color: '#ff4466' },
      
      // ì˜ˆì¸¡
      { id: 'F01', name: 'ë‘ë°”ì´ ìŠ¤í°ì„œ', label: 'ë‘ë°”ì´', role: 'FUTURE',
        lat: 25.2048, lon: 55.2708, location: 'Dubai, UAE',
        inflow: 0, outflow: 0, synergy: 0, forecast: 500000000,
        status: 'prediction', icon: 'â­', color: '#ffcc00' },
      
      { id: 'F02', name: 'ëŸ°ë˜ í™•ì¥', label: 'ëŸ°ë˜', role: 'FUTURE',
        lat: 51.5074, lon: -0.1278, location: 'London, UK',
        inflow: 0, outflow: 0, synergy: 0, forecast: 300000000,
        status: 'prediction', icon: 'â­', color: '#ffcc00' },
      
      { id: 'F03', name: 'ë² ì´ì§• JV', label: 'ë² ì´ì§•', role: 'FUTURE',
        lat: 39.9042, lon: 116.4074, location: 'Beijing, China',
        inflow: 0, outflow: 0, synergy: 0, forecast: 800000000,
        status: 'prediction', icon: 'â­', color: '#ffcc00' }
    ];
    
    const flows = [
      { from: 'C03', to: 'P01', value: 410000000, type: 'inflow' },
      { from: 'P01', to: 'P02', value: 60000000, type: 'inflow' },
      { from: 'P01', to: 'P03', value: 54000000, type: 'inflow' },
      { from: 'P01', to: 'P04', value: 36000000, type: 'inflow' },
      { from: 'P03', to: 'C01', value: 120000000, type: 'synergy' },
      { from: 'C01', to: 'C03', value: 250000000, type: 'synergy' },
      { from: 'X01', to: 'P01', value: 80000000, type: 'inflow' },
      { from: 'X02', to: 'P01', value: 200000000, type: 'inflow' },
      { from: 'P01', to: 'X03', value: 45000000, type: 'outflow' },
      { from: 'X03', to: 'P01', value: 30000000, type: 'inflow' },
      { from: 'P01', to: 'X04', value: 24000000, type: 'outflow' },
      { from: 'P01', to: 'F01', value: 500000000, type: 'prediction' },
      { from: 'P01', to: 'F02', value: 300000000, type: 'prediction' },
      { from: 'X01', to: 'F03', value: 400000000, type: 'prediction' },
      { from: 'X02', to: 'F01', value: 200000000, type: 'prediction' }
    ];
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Canvas ì˜¤ë²„ë ˆì´
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    const canvas = document.getElementById('canvas-overlay');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let isAnimating = true;
    let showBottlenecks = true;
    
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    
    // ìœ„ê²½ë„ â†’ í™”ë©´ ì¢Œí‘œ ë³€í™˜
    function latLonToPixel(lat, lon) {
      const point = map.latLngToContainerPoint([lat, lon]);
      return { x: point.x, y: point.y };
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // íŒŒí‹°í´ ì‹œìŠ¤í…œ
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function initParticles() {
      particles = [];
      flows.forEach(flow => {
        const count = flow.type === 'prediction' ? 5 : 3;
        for (let i = 0; i < count; i++) {
          particles.push({
            flowFrom: flow.from,
            flowTo: flow.to,
            flowType: flow.type,
            progress: Math.random(),
            speed: 0.003 + Math.random() * 0.004,
            size: flow.type === 'prediction' ? 5 : 4,
            trail: []
          });
        }
      });
    }
    
    function updateParticles() {
      particles.forEach(p => {
        p.progress += p.speed;
        if (p.progress > 1) {
          p.progress = 0;
          p.trail = [];
        }
        
        const fromNode = nodes.find(n => n.id === p.flowFrom);
        const toNode = nodes.find(n => n.id === p.flowTo);
        if (!fromNode || !toNode) return;
        
        const from = latLonToPixel(fromNode.lat, fromNode.lon);
        const to = latLonToPixel(toNode.lat, toNode.lon);
        
        const midX = (from.x + to.x) / 2;
        const midY = (from.y + to.y) / 2 - 50;
        
        const t = p.progress;
        p.x = Math.pow(1-t, 2) * from.x + 2 * (1-t) * t * midX + Math.pow(t, 2) * to.x;
        p.y = Math.pow(1-t, 2) * from.y + 2 * (1-t) * t * midY + Math.pow(t, 2) * to.y;
        
        p.trail.push({ x: p.x, y: p.y });
        if (p.trail.length > 20) p.trail.shift();
      });
    }
    
    initParticles();
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ë Œë”ë§
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function render() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      renderFlows();
      if (isAnimating) renderParticles();
      renderNodes();
    }
    
    function renderFlows() {
      flows.forEach(flow => {
        const fromNode = nodes.find(n => n.id === flow.from);
        const toNode = nodes.find(n => n.id === flow.to);
        if (!fromNode || !toNode) return;
        
        const from = latLonToPixel(fromNode.lat, fromNode.lon);
        const to = latLonToPixel(toNode.lat, toNode.lon);
        
        const midX = (from.x + to.x) / 2;
        const midY = (from.y + to.y) / 2 - 50;
        
        const gradient = ctx.createLinearGradient(from.x, from.y, to.x, to.y);
        
        if (flow.type === 'inflow') {
          gradient.addColorStop(0, 'rgba(0, 255, 136, 0.6)');
          gradient.addColorStop(1, 'rgba(0, 204, 255, 0.6)');
        } else if (flow.type === 'outflow') {
          gradient.addColorStop(0, 'rgba(255, 68, 102, 0.6)');
          gradient.addColorStop(1, 'rgba(255, 102, 0, 0.6)');
        } else if (flow.type === 'synergy') {
          gradient.addColorStop(0, 'rgba(153, 102, 255, 0.5)');
          gradient.addColorStop(1, 'rgba(0, 204, 255, 0.5)');
        } else if (flow.type === 'prediction') {
          gradient.addColorStop(0, 'rgba(255, 204, 0, 0.5)');
          gradient.addColorStop(1, 'rgba(255, 102, 0, 0.5)');
        }
        
        const width = Math.max(2, Math.sqrt(flow.value) / 4000);
        
        ctx.beginPath();
        ctx.moveTo(from.x, from.y);
        ctx.quadraticCurveTo(midX, midY, to.x, to.y);
        ctx.strokeStyle = gradient;
        ctx.lineWidth = width;
        
        if (flow.type === 'prediction') {
          ctx.setLineDash([8, 8]);
        } else {
          ctx.setLineDash([]);
        }
        
        ctx.stroke();
        ctx.setLineDash([]);
      });
    }
    
    function renderParticles() {
      particles.forEach(p => {
        if (!p.x || !p.y) return;
        
        let color;
        if (p.flowType === 'inflow') color = '#00ff88';
        else if (p.flowType === 'outflow') color = '#ff4466';
        else if (p.flowType === 'synergy') color = '#9966ff';
        else if (p.flowType === 'prediction') color = '#ffcc00';
        
        // íŠ¸ë ˆì¼
        if (p.trail.length > 1) {
          ctx.beginPath();
          ctx.moveTo(p.trail[0].x, p.trail[0].y);
          for (let i = 1; i < p.trail.length; i++) {
            ctx.lineTo(p.trail[i].x, p.trail[i].y);
          }
          const trailGradient = ctx.createLinearGradient(p.trail[0].x, p.trail[0].y, p.x, p.y);
          trailGradient.addColorStop(0, 'rgba(255, 255, 255, 0)');
          trailGradient.addColorStop(1, color);
          ctx.strokeStyle = trailGradient;
          ctx.lineWidth = 2;
          ctx.stroke();
        }
        
        // íŒŒí‹°í´
        const opacity = 0.5 + 0.5 * Math.sin(p.progress * Math.PI);
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fillStyle = color;
        ctx.shadowColor = color;
        ctx.shadowBlur = 15;
        ctx.globalAlpha = opacity;
        ctx.fill();
        ctx.globalAlpha = 1;
        ctx.shadowBlur = 0;
      });
    }
    
    function renderNodes() {
      nodes.forEach(node => {
        const pos = latLonToPixel(node.lat, node.lon);
        const totalValue = node.inflow + node.outflow + Math.abs(node.synergy) + (node.forecast || 0);
        const size = Math.max(15, Math.sqrt(totalValue) / 4000);
        
        // ê¸€ë¡œìš°
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, size * 2, 0, Math.PI * 2);
        ctx.fillStyle = node.color + '20';
        ctx.fill();
        
        // ë³‘ëª© ê²½ê³  ë§
        if (node.status === 'bottleneck' && showBottlenecks) {
          ctx.beginPath();
          ctx.arc(pos.x, pos.y, size * 2.5, 0, Math.PI * 2);
          ctx.strokeStyle = '#ff4466';
          ctx.lineWidth = 3;
          ctx.shadowColor = '#ff4466';
          ctx.shadowBlur = 20;
          ctx.stroke();
          ctx.shadowBlur = 0;
        }
        
        // ì˜ˆì¸¡ ì ì„ 
        if (node.status === 'prediction') {
          ctx.beginPath();
          ctx.arc(pos.x, pos.y, size * 1.8, 0, Math.PI * 2);
          ctx.setLineDash([4, 4]);
          ctx.strokeStyle = '#ffcc00';
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.setLineDash([]);
        }
        
        // ë©”ì¸ ë…¸ë“œ
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, size, 0, Math.PI * 2);
        ctx.fillStyle = node.color;
        ctx.shadowColor = node.color;
        ctx.shadowBlur = 12;
        ctx.fill();
        ctx.shadowBlur = 0;
        
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        // ì•„ì´ì½˜
        ctx.font = `${size * 0.9}px sans-serif`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = '#fff';
        ctx.fillText(node.icon, pos.x, pos.y);
        
        // ë¼ë²¨
        const zoom = map.getZoom();
        if (zoom > 3) {
          ctx.font = '11px sans-serif';
          ctx.fillStyle = '#fff';
          ctx.fillText(node.name, pos.x, pos.y + size + 14);
        }
      });
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function animate() {
      updateParticles();
      render();
      requestAnimationFrame(animate);
    }
    
    animate();
    
    // ì§€ë„ ì´ë™ ì‹œ ì¬ë Œë”ë§
    map.on('move', () => {
      initParticles();
    });
    
    map.on('zoom', () => {
      initParticles();
    });
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ì´ë²¤íŠ¸
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    canvas.style.pointerEvents = 'auto';
    canvas.addEventListener('click', e => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      let clicked = null;
      let minDist = Infinity;
      
      nodes.forEach(node => {
        const pos = latLonToPixel(node.lat, node.lon);
        const dist = Math.sqrt(Math.pow(pos.x - x, 2) + Math.pow(pos.y - y, 2));
        const size = 30;
        if (dist < size && dist < minDist) {
          minDist = dist;
          clicked = node;
        }
      });
      
      if (clicked) {
        showNodeInfo(clicked);
      } else {
        document.getElementById('info-panel').classList.remove('visible');
        // ì§€ë„ í´ë¦­ ì „ë‹¬
        canvas.style.pointerEvents = 'none';
        setTimeout(() => { canvas.style.pointerEvents = 'auto'; }, 100);
      }
    });
    
    function showNodeInfo(node) {
      const panel = document.getElementById('info-panel');
      panel.classList.add('visible');
      
      document.getElementById('info-icon').textContent = node.icon;
      document.getElementById('info-icon').style.background = node.color;
      document.getElementById('info-name').textContent = node.name;
      document.getElementById('info-type').textContent = `${node.role} â€¢ ${node.label}`;
      document.getElementById('info-location').textContent = `ğŸ“ ${node.location}`;
      document.getElementById('info-inflow').textContent = formatMoney(node.inflow);
      document.getElementById('info-outflow').textContent = formatMoney(node.outflow);
      document.getElementById('info-synergy').textContent = (node.synergy >= 0 ? '+' : '') + formatMoney(node.synergy);
      
      const totalValue = node.inflow - node.outflow + node.synergy;
      document.getElementById('info-value').textContent = formatMoney(totalValue);
      
      const statusEl = document.getElementById('info-status');
      if (node.status === 'optimal') {
        statusEl.className = 'info-status status-optimal';
        statusEl.textContent = 'âœ… OPTIMAL';
      } else if (node.status === 'warning') {
        statusEl.className = 'info-status status-warning';
        statusEl.textContent = 'âš ï¸ WARNING';
      } else if (node.status === 'bottleneck') {
        statusEl.className = 'info-status status-bottleneck';
        statusEl.textContent = 'ğŸš¨ BOTTLENECK';
      } else if (node.status === 'prediction') {
        statusEl.className = 'info-status status-prediction';
        statusEl.textContent = 'â­ FORECAST: ' + formatMoney(node.forecast);
      }
    }
    
    // ì»¨íŠ¸ë¡¤ ë²„íŠ¼
    document.getElementById('btn-korea').addEventListener('click', () => {
      map.flyTo([37.5, 127], 11, { duration: 1.5 });
    });
    
    document.getElementById('btn-asia').addEventListener('click', () => {
      map.flyTo([25, 110], 4, { duration: 1.5 });
    });
    
    document.getElementById('btn-world').addEventListener('click', () => {
      map.flyTo([30, 100], 3, { duration: 1.5 });
    });
    
    document.getElementById('btn-animate').addEventListener('click', function() {
      isAnimating = !isAnimating;
      this.classList.toggle('active', isAnimating);
      this.textContent = isAnimating ? 'âœ¨ ë³„ë˜¥ë³„' : 'âœ¨ ì •ì§€';
    });
    
    document.getElementById('btn-bottleneck').addEventListener('click', function() {
      showBottlenecks = !showBottlenecks;
      this.classList.toggle('active', showBottlenecks);
      this.textContent = showBottlenecks ? 'âš ï¸ ë³‘ëª©' : 'âš ï¸ ìˆ¨ê¹€';
    });
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ìœ í‹¸ë¦¬í‹°
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function formatMoney(value) {
      if (Math.abs(value) >= 100000000) return 'â‚©' + (value / 100000000).toFixed(2) + 'ì–µ';
      if (Math.abs(value) >= 10000) return 'â‚©' + Math.round(value / 10000).toLocaleString() + 'ë§Œ';
      return 'â‚©' + value.toLocaleString();
    }
    
    console.log('ğŸ›°ï¸ AUTUS Physics Map - Satellite Edition initialized');
    console.log('ğŸ“¡ Layers: Satellite, Hybrid, Terrain, Dark, NDVI');
    console.log('ğŸŒ Nodes:', nodes.length);
    console.log('ğŸ’° Flows:', flows.length);
  </script>
</body>
</html>
